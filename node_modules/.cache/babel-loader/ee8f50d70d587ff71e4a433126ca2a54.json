{"remainingRequest":"/Users/juann1095/Documents/IEA/Sistema Integral de Formación Continua 2.0/node_modules/thread-loader/dist/cjs.js!/Users/juann1095/Documents/IEA/Sistema Integral de Formación Continua 2.0/node_modules/babel-loader/lib/index.js!/Users/juann1095/Documents/IEA/Sistema Integral de Formación Continua 2.0/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/juann1095/Documents/IEA/Sistema Integral de Formación Continua 2.0/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/juann1095/Documents/IEA/Sistema Integral de Formación Continua 2.0/src/components/subpaginas/AdminOfertasFormComponent.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/juann1095/Documents/IEA/Sistema Integral de Formación Continua 2.0/src/components/subpaginas/AdminOfertasFormComponent.vue","mtime":1645809942000},{"path":"/Users/juann1095/Documents/IEA/Sistema Integral de Formación Continua 2.0/babel.config.js","mtime":1645809942000},{"path":"/Users/juann1095/Documents/IEA/Sistema Integral de Formación Continua 2.0/node_modules/cache-loader/dist/cjs.js","mtime":1728489819214},{"path":"/Users/juann1095/Documents/IEA/Sistema Integral de Formación Continua 2.0/node_modules/thread-loader/dist/cjs.js","mtime":1728489819179},{"path":"/Users/juann1095/Documents/IEA/Sistema Integral de Formación Continua 2.0/node_modules/babel-loader/lib/index.js","mtime":1728489820331},{"path":"/Users/juann1095/Documents/IEA/Sistema Integral de Formación Continua 2.0/node_modules/cache-loader/dist/cjs.js","mtime":1728489819214},{"path":"/Users/juann1095/Documents/IEA/Sistema Integral de Formación Continua 2.0/node_modules/vue-loader/lib/index.js","mtime":1728489820388}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IFJlZ2lzdHJvT2ZlcnRhTW9kYWwgZnJvbSAiLi4vbW9kYWxzL3JlZ2lzdHJvT2ZlcnRhTW9kYWwiOwppbXBvcnQgUmVnaXN0cm9HcnVwb01vZGFsIGZyb20gIi4uL21vZGFscy9yZWdpc3Ryb0dydXBvTW9kYWwiOwppbXBvcnQgRXhjZWxqcyBmcm9tICJleGNlbGpzIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJBZG1pbk9mZXJ0YXNGb3JtQ29tcG9uZW50IiwKICBjb21wb25lbnRzOiB7CiAgICBSZWdpc3Ryb09mZXJ0YU1vZGFsLAogICAgUmVnaXN0cm9HcnVwb01vZGFsCiAgfSwKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG9mZXJ0YVNlbGVjdGVkOiBmYWxzZSwKICAgICAgZ3J1cG9TZWxlY3RlZDogZmFsc2UsCiAgICAgIG5vbWJyZU9mZXJ0YTogIiIsCiAgICAgIGlkT2ZlcnRhOiAiIiwKICAgICAgbW9kYWxSZWdpc3Ryb09mZXJ0YTogZmFsc2UsCiAgICAgIG1vZGFsUmVnaXN0cm9HcnVwbzogZmFsc2UsCiAgICAgIGVudl91cmw6IHByb2Nlc3MuZW52LlZVRV9BUFBfVVJMLAogICAgICBmaWx0ZXI6IG51bGwsCiAgICAgIG9mZXJ0YXM6IFtdLAogICAgICBjYXJnYW5kbzogZmFsc2UsCiAgICAgIGZpZWxkczogW3sKICAgICAgICBrZXk6ICJpbWciCiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJub21icmUiLAogICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJzaG93X2RldGFpbHMiLAogICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgIH1dCiAgICB9OwogIH0sCgogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmdldE9mZXJ0YXMoKTsKICB9LAoKICBtZXRob2RzOiB7CiAgICBnZXRPZmVydGFzKCkgewogICAgICB0aGlzLmNhcmdhbmRvID0gdHJ1ZTsKICAgICAgYXhpb3MuZ2V0KHRoaXMuZW52X3VybCArICIvb2ZlcnRhc0Zvcm1hY2lvbiIsIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAiYmVhcmVyICIgKyBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpCiAgICAgICAgfQogICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgY29uc29sZS5sb2cocmVzLmRhdGEpOwogICAgICAgIHRoaXMub2ZlcnRhcyA9IHJlcy5kYXRhLm9mZXJ0YXNGb3JtYWNpb247CiAgICAgICAgdGhpcy5jYXJnYW5kbyA9IGZhbHNlOwogICAgICB9KTsKICAgIH0sCgogICAgb3Blbk1vZGFsR3J1cG8oaWRPZmVydGEsIG5vbWJyZU9mZXJ0YSwgZ3J1cG8gPSBmYWxzZSkgewogICAgICB0aGlzLmlkT2ZlcnRhID0gaWRPZmVydGE7CiAgICAgIHRoaXMubm9tYnJlT2ZlcnRhID0gbm9tYnJlT2ZlcnRhOwoKICAgICAgaWYgKGdydXBvKSB7CiAgICAgICAgdGhpcy5ncnVwb1NlbGVjdGVkID0ge307CiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmdydXBvU2VsZWN0ZWQsIGdydXBvKTsKICAgICAgICB0aGlzLmdydXBvU2VsZWN0ZWQuY3VwbyA9IGdydXBvLmN1cG9bMF07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5ncnVwb1NlbGVjdGVkID0gZmFsc2U7CiAgICAgIH0KCiAgICAgIHRoaXMubW9kYWxSZWdpc3Ryb0dydXBvID0gdHJ1ZTsKICAgIH0sCgogICAgb3Blbk1vZGFsT2ZlcnRhKG9mZXJ0YSA9IGZhbHNlKSB7CiAgICAgIGlmIChvZmVydGEpIHsKICAgICAgICB0aGlzLm9mZXJ0YVNlbGVjdGVkID0ge307CiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLm9mZXJ0YVNlbGVjdGVkLCBvZmVydGEpOwogICAgICAgIHRoaXMub2ZlcnRhU2VsZWN0ZWQuaW5zdGl0dWNpb25fZm9ybWFkb3JhID0gb2ZlcnRhLmluc3RpdHVjaW9uX2Zvcm1hZG9yYS5faWQ7CiAgICAgICAgdGhpcy5vZmVydGFTZWxlY3RlZC5ub21icmVfY3Vyc28gPSBvZmVydGEubm9tYnJlX2N1cnNvWzBdOwogICAgICAgIHRoaXMub2ZlcnRhU2VsZWN0ZWQubW9kYWxpZGFkID0gb2ZlcnRhLm1vZGFsaWRhZC5faWQ7CiAgICAgICAgdGhpcy5vZmVydGFTZWxlY3RlZC5wcmVzdXB1ZXN0byA9IG9mZXJ0YS5wcmVzdXB1ZXN0by5faWQ7CiAgICAgICAgdGhpcy5vZmVydGFTZWxlY3RlZC50aXBvX29mZXJ0YSA9IG9mZXJ0YS50aXBvX29mZXJ0YS5faWQ7CiAgICAgICAgbGV0IGRpcmlnaWRvID0gb2ZlcnRhLmRpcmlnaWRvOwogICAgICAgIHRoaXMub2ZlcnRhU2VsZWN0ZWQuZGlyaWdpZG8gPSBbXTsKCiAgICAgICAgZm9yIChsZXQgaSBpbiBkaXJpZ2lkbykgewogICAgICAgICAgdGhpcy5vZmVydGFTZWxlY3RlZC5kaXJpZ2lkby5wdXNoKGRpcmlnaWRvW2ldLl9pZCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMub2ZlcnRhU2VsZWN0ZWQgPSBmYWxzZTsKICAgICAgfQoKICAgICAgdGhpcy5tb2RhbFJlZ2lzdHJvT2ZlcnRhID0gdHJ1ZTsKICAgIH0sCgogICAgcmVwb3J0ZUV4Y2VsKCkgewogICAgICBheGlvcy5nZXQocHJvY2Vzcy5lbnYuVlVFX0FQUF9VUkwgKyAiL2VuY29kZTY0L2xvZ28vaWVhX2xvZ28uanBnIiwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJiZWFyZXIgIiArIHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oInRva2VuIikKICAgICAgICB9CiAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICBjb25zdCBsaWJybyA9IG5ldyBFeGNlbGpzLldvcmtib29rKCk7CiAgICAgICAgY29uc3QgaG9qYTEgPSBsaWJyby5hZGRXb3Jrc2hlZXQoIkhvamEgZGUgcHJ1ZWJhIik7CiAgICAgICAgY29uc3QgbG9nb0lFQSA9IGxpYnJvLmFkZEltYWdlKHsKICAgICAgICAgIGJhc2U2NGZpbGVuYW1lOiAiaW1nL2ltZ19sb2dvLmpwZyIsCiAgICAgICAgICBleHRlbnNpb246IHJlcy5kYXRhLmV4dCwKICAgICAgICAgIGJhc2U2NDogcmVzLmRhdGEuY2FkZW5hCiAgICAgICAgfSk7CiAgICAgICAgaG9qYTEuYWRkSW1hZ2UobG9nb0lFQSwgIkEyOkI3Iik7CiAgICAgICAgaG9qYTEuZ2V0Q2VsbCgiRDQiKS5mb250ID0gewogICAgICAgICAgYm9sZDogdHJ1ZSwKICAgICAgICAgIHNpemU6IDE0CiAgICAgICAgfTsKICAgICAgICBob2phMS5nZXRDZWxsKCJENCIpLnZhbHVlID0gIkNhdMOhbG9nbyBkZSBvZmVydGFzIGRlIGZvcm1hY2nDs24iOwogICAgICAgIGhvamExLmdldFJvdyg5KS52YWx1ZXMgPSBbImlkIE9mZXJ0YSIsICJOb21icmUiLCAiUGVyaW9kbyIsICJpZCBJbnN0YW5jaWEiLCAiSW5zdGFuY2lhIl07CiAgICAgICAgbGlicm8ueGxzeC53cml0ZUJ1ZmZlcigpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbZGF0YV0sIHsKICAgICAgICAgICAgdHlwZTogImFwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC5zcHJlYWRzaGVldG1sLnNoZWV0IgogICAgICAgICAgfSk7CiAgICAgICAgICBjb25zdCB1cmwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgICAgICAgIGNvbnN0IGFuY2hvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTsKICAgICAgICAgIGNvbnNvbGUubG9nKGFuY2hvci5ocmVmKTsKICAgICAgICAgIGFuY2hvci5ocmVmID0gdXJsOwogICAgICAgICAgYW5jaG9yLmRvd25sb2FkID0gImRvd25sb2FkLnhsc3giOwogICAgICAgICAgYW5jaG9yLmNsaWNrKCk7CiAgICAgICAgICB3aW5kb3cuVVJMLnJldm9rZU9iamVjdFVSTCh1cmwpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KCiAgfQp9Ow=="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwGA;AACA;AACA;AACA;AAEA;EACAA,iCADA;EAEAC;IAAAC;IAAAC;EAAA,CAFA;;EAGAC;IACA;MACAC,qBADA;MAEAC,oBAFA;MAGAC,gBAHA;MAIAC,YAJA;MAKAC,0BALA;MAMAC,yBANA;MAOAC,gCAPA;MAQAC,YARA;MASAC,WATA;MAUAC,eAVA;MAWAC,SACA;QACAC;MADA,CADA,EAIA;QACAA,aADA;QAEAC;MAFA,CAJA,EAQA;QACAD,mBADA;QAEAC;MAFA,CARA;IAXA;EAyBA,CA7BA;;EA8BAC;IACA;EACA,CAhCA;;EAiCAC;IACAC;MACA;MACAC,MACAC,GADA,CACA,kCADA,EACA;QACAC;UACAC;QADA;MADA,CADA,EAMAC,IANA,CAMAC;QACAC;QACA;QACA;MACA,CAVA;IAWA,CAdA;;IAeAC;MACA;MACA;;MACA;QACA;QACAC;QACA;MACA,CAJA,MAIA;QACA;MACA;;MACA;IACA,CA1BA;;IA2BAC;MACA;QACA;QACAD;QACA,4CACAE,gCADA;QAEA;QACA;QACA;QACA;QACA;QACA;;QACA;UACA;QACA;MACA,CAdA,MAcA;QACA;MACA;;MACA;IACA,CA9CA;;IA+CAC;MACAX,MACAC,GADA,CACAW,uDADA,EACA;QACAV;UACAC;QADA;MADA,CADA,EAMAC,IANA,CAMAC;QACA;QACA;QACA;UACAQ,kCADA;UAEAC,uBAFA;UAGAC;QAHA;QAKAC;QACAA;UACAC,UADA;UAEAC;QAFA;QAIAF;QACAA,0BACA,WADA,EAEA,QAFA,EAGA,SAHA,EAIA,cAJA,EAKA,WALA;QAOAG;UACA;YACAC,MACA;UAFA;UAIA;UACA;UACAd;UACAe;UACAA;UACAA;UACAC;QACA,CAZA;MAaA,CAxCA;IAyCA;;EAzFA;AAjCA","names":["name","components","RegistroOfertaModal","RegistroGrupoModal","data","ofertaSelected","grupoSelected","nombreOferta","idOferta","modalRegistroOferta","modalRegistroGrupo","env_url","filter","ofertas","cargando","fields","key","sortable","mounted","methods","getOfertas","axios","get","headers","Authorization","then","res","console","openModalGrupo","Object","openModalOferta","oferta","reporteExcel","process","base64filename","extension","base64","hoja1","bold","size","libro","type","anchor","window"],"sourceRoot":"src/components/subpaginas","sources":["AdminOfertasFormComponent.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <h3>Ofertas de Formación</h3>\r\n    <h4>Catálogo de Ofertas de Formación</h4>\r\n    <hr />\r\n    <b-form-group label=\"Filtro:\" label-for=\"filterInput\">\r\n      <b-input-group>\r\n        <b-form-input\r\n          v-model=\"filter\"\r\n          type=\"search\"\r\n          id=\"filterInput\"\r\n          placeholder=\"Escribe un dato a filtrar\"\r\n        ></b-form-input>\r\n        <b-input-group-append>\r\n          <b-button :disabled=\"!filter\" @click=\"filter = ''\">Limpiar</b-button>\r\n        </b-input-group-append>\r\n      </b-input-group>\r\n    </b-form-group>\r\n    <b-button variant=\"success\" @click=\"openModalOferta()\"\r\n      >Nueva Oferta</b-button\r\n    >\r\n    <b-button variant=\"warning\" @click=\"reporteExcel()\">Reporte .xlsx</b-button>\r\n    <div>\r\n      <b-table\r\n        striped\r\n        hover\r\n        :items=\"ofertas\"\r\n        :busy=\"cargando\"\r\n        :fields=\"fields\"\r\n        :filter=\"filter\"\r\n      >\r\n        <template v-slot:table-busy>\r\n          <div class=\"text-center text-danger my-2\">\r\n            <b-spinner class=\"align-middle\"></b-spinner>\r\n            <strong>Cargando...</strong>\r\n          </div>\r\n        </template>\r\n        <template v-slot:cell(img)=\"row\">\r\n          <img\r\n            height=\"auto\"\r\n            width=\"100px\"\r\n            :src=\"\r\n              env_url +\r\n              '/backassets/logos/' +\r\n              row.item.institucion_formadora.img\r\n            \"\r\n          />\r\n        </template>\r\n        <template #cell(nombre)=\"row\">\r\n          {{ row.item.nombre_curso[0] }}\r\n        </template>\r\n        <template #cell(show_details)=\"row\">\r\n          <b-button size=\"sm\" class=\"mr-2\" @click=\"row.toggleDetails\">\r\n            {{ row.detailsShowing ? \"Ocultar\" : \"Mostrar\" }} Detalles\r\n          </b-button>\r\n        </template>\r\n        <template #row-details=\"row\">\r\n          <b-card>\r\n            <b-row class=\"mb-2\">\r\n              <b-col sm=\"3\" class=\"text-sm-right\"><b>Id:</b></b-col>\r\n              <b-col>{{ row.item._id }}</b-col>\r\n            </b-row>\r\n            <b-row class=\"mb-2\">\r\n              <b-col sm=\"3\" class=\"text-sm-right\"><b>Grupos:</b></b-col>\r\n              <b-col>\r\n                <ul>\r\n                  <li v-for=\"grupo in row.item.grupos\" :key=\"grupo.key\">\r\n                    <button\r\n                      v-on:click=\"\r\n                        openModalGrupo(\r\n                          row.item._id,\r\n                          row.item.nombre_curso[0],\r\n                          grupo\r\n                        )\r\n                      \"\r\n                    >\r\n                      {{ grupo.grupo + \" / \" + grupo.observacion }}\r\n                    </button>\r\n                  </li>\r\n                </ul>\r\n              </b-col>\r\n            </b-row>\r\n\r\n            <b-button size=\"sm\" @click=\"row.toggleDetails\"\r\n              >Ocultar Detalles</b-button\r\n            >\r\n            <b-button class=\"m-3\" size=\"sm\" @click=\"openModalOferta(row.item)\"\r\n              >Editar</b-button\r\n            >\r\n            <b-button\r\n              size=\"sm\"\r\n              @click=\"openModalGrupo(row.item._id, row.item.nombre_curso[0])\"\r\n              >Abrir Grupo</b-button\r\n            >\r\n          </b-card>\r\n        </template>\r\n      </b-table>\r\n    </div>\r\n    <RegistroOfertaModal></RegistroOfertaModal>\r\n    <RegistroGrupoModal></RegistroGrupoModal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport RegistroOfertaModal from \"../modals/registroOfertaModal\";\r\nimport RegistroGrupoModal from \"../modals/registroGrupoModal\";\r\nimport Exceljs from \"exceljs\";\r\n\r\nexport default {\r\n  name: \"AdminOfertasFormComponent\",\r\n  components: { RegistroOfertaModal, RegistroGrupoModal },\r\n  data() {\r\n    return {\r\n      ofertaSelected: false,\r\n      grupoSelected: false,\r\n      nombreOferta: \"\",\r\n      idOferta: \"\",\r\n      modalRegistroOferta: false,\r\n      modalRegistroGrupo: false,\r\n      env_url: process.env.VUE_APP_URL,\r\n      filter: null,\r\n      ofertas: [],\r\n      cargando: false,\r\n      fields: [\r\n        {\r\n          key: \"img\",\r\n        },\r\n        {\r\n          key: \"nombre\",\r\n          sortable: true,\r\n        },\r\n        {\r\n          key: \"show_details\",\r\n          sortable: true,\r\n        },\r\n      ],\r\n    };\r\n  },\r\n  mounted() {\r\n    this.getOfertas();\r\n  },\r\n  methods: {\r\n    getOfertas() {\r\n      this.cargando = true;\r\n      axios\r\n        .get(this.env_url + \"/ofertasFormacion\", {\r\n          headers: {\r\n            Authorization: \"bearer \" + sessionStorage.getItem(\"token\"),\r\n          },\r\n        })\r\n        .then((res) => {\r\n          console.log(res.data);\r\n          this.ofertas = res.data.ofertasFormacion;\r\n          this.cargando = false;\r\n        });\r\n    },\r\n    openModalGrupo(idOferta, nombreOferta, grupo = false) {\r\n      this.idOferta = idOferta;\r\n      this.nombreOferta = nombreOferta;\r\n      if (grupo) {\r\n        this.grupoSelected = {};\r\n        Object.assign(this.grupoSelected, grupo);\r\n        this.grupoSelected.cupo = grupo.cupo[0];\r\n      } else {\r\n        this.grupoSelected = false;\r\n      }\r\n      this.modalRegistroGrupo = true;\r\n    },\r\n    openModalOferta(oferta = false) {\r\n      if (oferta) {\r\n        this.ofertaSelected = {};\r\n        Object.assign(this.ofertaSelected, oferta);\r\n        this.ofertaSelected.institucion_formadora =\r\n          oferta.institucion_formadora._id;\r\n        this.ofertaSelected.nombre_curso = oferta.nombre_curso[0];\r\n        this.ofertaSelected.modalidad = oferta.modalidad._id;\r\n        this.ofertaSelected.presupuesto = oferta.presupuesto._id;\r\n        this.ofertaSelected.tipo_oferta = oferta.tipo_oferta._id;\r\n        let dirigido = oferta.dirigido;\r\n        this.ofertaSelected.dirigido = [];\r\n        for (let i in dirigido) {\r\n          this.ofertaSelected.dirigido.push(dirigido[i]._id);\r\n        }\r\n      } else {\r\n        this.ofertaSelected = false;\r\n      }\r\n      this.modalRegistroOferta = true;\r\n    },\r\n    reporteExcel() {\r\n      axios\r\n        .get(process.env.VUE_APP_URL + \"/encode64/logo/iea_logo.jpg\", {\r\n          headers: {\r\n            Authorization: \"bearer \" + sessionStorage.getItem(\"token\"),\r\n          },\r\n        })\r\n        .then((res) => {\r\n          const libro = new Exceljs.Workbook();\r\n          const hoja1 = libro.addWorksheet(\"Hoja de prueba\");\r\n          const logoIEA = libro.addImage({\r\n            base64filename: \"img/img_logo.jpg\",\r\n            extension: res.data.ext,\r\n            base64: res.data.cadena\r\n          });\r\n          hoja1.addImage(logoIEA, \"A2:B7\");\r\n          hoja1.getCell(\"D4\").font = {\r\n            bold: true,\r\n            size: 14,\r\n          };\r\n          hoja1.getCell(\"D4\").value = \"Catálogo de ofertas de formación\";\r\n          hoja1.getRow(9).values = [\r\n            \"id Oferta\",\r\n            \"Nombre\",\r\n            \"Periodo\",\r\n            \"id Instancia\",\r\n            \"Instancia\",\r\n          ];\r\n          libro.xlsx.writeBuffer().then(function (data) {\r\n            const blob = new Blob([data], {\r\n              type:\r\n                \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\r\n            });\r\n            const url = window.URL.createObjectURL(blob);\r\n            const anchor = document.createElement(\"a\");\r\n            console.log(anchor.href);\r\n            anchor.href = url;\r\n            anchor.download = \"download.xlsx\";\r\n            anchor.click();\r\n            window.URL.revokeObjectURL(url);\r\n          });\r\n        });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\nb-col,\r\nul,\r\nli a {\r\n  cursor: pointer;\r\n  color: blue;\r\n}\r\n</style>\r\n"]}]}